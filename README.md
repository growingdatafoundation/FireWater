add existing code from old firewater project
